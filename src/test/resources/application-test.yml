micronaut:
  application:
    name: nfcwalker
  test-resources:
    enabled: false
  security:
    enabled: true
    authentication: bearer
    token:
      jwt:
        roles-claim: roles
        signatures:
          secret:
            default:
              # Named secret entry (default) with explicit value for verification
              secret: 0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
              generator:
                secret: 0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
  email:
    from:
      email: ${MAIL_FROM:noreply@nfcwalker.com}
      name: ${APP_NAME:NFC Walker}

# Disable JavaMail authentication for tests (Mailhog doesn't require auth)
javamail:
  authentication:
    enabled: false
  properties:
    mail.transport.protocol: smtp
    mail.smtp.host: ${SMTP_HOST:localhost}
    mail.smtp.port: ${SMTP_PORT:1025}
    mail.smtp.auth: false
    mail.smtp.starttls.enable: false

# Test-only toggles
test:
  security:
    rule:
      enabled: false

datasources:
  default:
    url: "jdbc:tc:postgresql:15:///testdb"
    username: test
    password: test
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver
    db-type: postgres

mail:
  smtp:
    host: ${SMTP_HOST:localhost}
    port: ${SMTP_PORT:1025}
    auth: ${SMTP_AUTH:false}
    from: ${MAIL_FROM:noreply@nfcwalker.com}

app:
  name: ${APP_NAME:NFC Walker}
  frontend-url: ${FRONTEND_URL:http://localhost:3000}
  email:
    default-language: ${APP_EMAIL_DEFAULT_LANGUAGE:en}
  template-base: templates
  # Use a 32-byte (256-bit) secret for challenge signing in tests to satisfy HS256
  challenge:
    secret: 0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
    ttl-seconds: 60

# Enable debug logging for security to diagnose token validation issues during tests
logging:
  level:
    io.micronaut.security: DEBUG
    io.micronaut.security.token: DEBUG
    io.micronaut.security.token.jwt: DEBUG
