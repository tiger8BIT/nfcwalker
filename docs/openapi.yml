openapi: 3.0.1
info:
  title: nfcwalker
  version: 1.0.0
paths:
  /api/admin/checkpoints:
    get:
      operationId: listCheckpoints
      parameters:
      - name: siteId
        in: query
        explode: false
        schema:
          type: string
          format: uuid
          nullable: true
      - name: orgId
        in: query
        explode: false
        schema:
          type: string
          format: uuid
          nullable: true
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: listCheckpoints 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_CheckpointResponse_"
    post:
      operationId: createCheckpoint
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateCheckpointRequest"
        required: true
      responses:
        "200":
          description: createCheckpoint 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CheckpointResponse"
  /api/admin/checkpoints/{id}:
    get:
      operationId: getCheckpoint
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getCheckpoint 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CheckpointResponse"
    put:
      operationId: updateCheckpoint
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateCheckpointRequest"
        required: true
      responses:
        "200":
          description: updateCheckpoint 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CheckpointResponse"
    delete:
      operationId: deleteCheckpoint
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: deleteCheckpoint 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/admin/routes:
    get:
      operationId: listRoutes
      parameters:
      - name: orgId
        in: query
        explode: false
        schema:
          type: string
          format: uuid
          nullable: true
      - name: siteId
        in: query
        explode: false
        schema:
          type: string
          format: uuid
          nullable: true
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: listRoutes 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_RouteResponse_"
    post:
      operationId: createRoute
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateRouteRequest"
        required: true
      responses:
        "200":
          description: createRoute 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RouteResponse"
  /api/admin/routes/{id}:
    get:
      operationId: getRoute
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getRoute 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RouteResponse"
    put:
      operationId: updateRoute
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateRouteRequest"
        required: true
      responses:
        "200":
          description: updateRoute 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RouteResponse"
    delete:
      operationId: deleteRoute
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: deleteRoute 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/admin/routes/{id}/points:
    post:
      operationId: addCheckpointsToRoute
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkAddRouteCheckpointsRequest"
        required: true
      responses:
        "200":
          description: addCheckpointsToRoute 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: object
  /api/dev/database/reset:
    delete:
      operationId: resetDatabase
      responses:
        "200":
          description: resetDatabase 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/dev/invitations/{id}/token:
    get:
      operationId: getInvitationToken
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getInvitationToken 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/devices:
    get:
      operationId: getUserDevices
      parameters:
      - name: organizationId
        in: query
        required: true
        explode: false
        schema:
          type: string
          format: uuid
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: getUserDevices 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_DeviceResponse_"
    post:
      operationId: registerDevice
      parameters:
      - name: organizationId
        in: query
        required: true
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterDeviceRequest"
        required: true
      responses:
        "200":
          description: registerDevice 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeviceResponse"
  /api/devices/{id}:
    get:
      operationId: getDevice
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getDevice 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeviceResponse"
    delete:
      operationId: revokeDevice
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: revokeDevice 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/incidents:
    get:
      operationId: listIncidents
      parameters:
      - name: organizationId
        in: query
        required: true
        explode: false
        schema:
          type: string
          format: uuid
      - name: siteId
        in: query
        explode: false
        schema:
          type: string
          format: uuid
          nullable: true
      - name: status
        in: query
        explode: false
        schema:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/IncidentStatus"
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: listIncidents 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_IncidentResponse_"
    post:
      operationId: createIncident
      requestBody:
        content:
          multipart/form-data:
            schema:
              required:
              - metadata
              type: object
              properties:
                metadata:
                  $ref: "#/components/schemas/IncidentCreateRequest"
                photos:
                  type: array
                  nullable: true
                  items:
                    type: string
                    format: binary
            encoding:
              metadata:
                contentType: application/octet-stream
                explode: true
              photos:
                contentType: application/octet-stream
                explode: true
        required: true
      responses:
        "200":
          description: createIncident 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IncidentResponse"
  /api/incidents/{id}:
    get:
      operationId: getIncident
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getIncident 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IncidentResponse"
    delete:
      operationId: deleteIncident
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: deleteIncident 200 response
    patch:
      operationId: patchIncident
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/IncidentPatchRequest"
        required: true
      responses:
        "200":
          description: patchIncident 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IncidentResponse"
  /api/incidents/{id}/attach-scan/{scanEventId}:
    post:
      operationId: attachToScan
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: scanEventId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: attachToScan 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IncidentResponse"
  /api/incidents/{id}/photos:
    post:
      operationId: addPhotosToIncident
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                photos:
                  type: array
                  nullable: true
                  items:
                    type: string
                    format: binary
            encoding:
              photos:
                contentType: application/octet-stream
                explode: false
        required: true
      responses:
        "200":
          description: addPhotosToIncident 200 response
          content:
            application/json:
              schema:
                type: object
  /api/incidents/{id}/photos/{photoId}:
    delete:
      operationId: deletePhotoFromIncident
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: photoId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: deletePhotoFromIncident 200 response
  /api/invitations:
    get:
      operationId: getInvitations
      parameters:
      - name: organizationId
        in: query
        required: true
        explode: false
        schema:
          type: string
          format: uuid
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: getInvitations 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_InvitationResponse_"
    post:
      operationId: createInvitation
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateInvitationRequest"
        required: true
      responses:
        "200":
          description: createInvitation 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvitationResponse"
  /api/invitations/{id}:
    get:
      operationId: getInvitation
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getInvitation 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvitationResponse"
    delete:
      operationId: cancelInvitation
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: cancelInvitation 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/organizations:
    get:
      operationId: listOrganizations
      parameters:
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: listOrganizations 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_OrganizationResponse_"
    post:
      operationId: createOrganization
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrganizationRequest"
        required: true
      responses:
        "200":
          description: createOrganization 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationResponse"
  /api/organizations/{id}:
    get:
      operationId: getOrganization
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getOrganization 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationResponse"
    put:
      operationId: updateOrganization
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateOrganizationRequest"
        required: true
      responses:
        "200":
          description: updateOrganization 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationResponse"
    delete:
      operationId: deleteOrganization
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: deleteOrganization 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: object
  /api/routes:
    get:
      operationId: listRoutes_1
      parameters:
      - name: orgId
        in: query
        explode: false
        schema:
          type: string
          format: uuid
          nullable: true
      - name: siteId
        in: query
        explode: false
        schema:
          type: string
          format: uuid
          nullable: true
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: listRoutes_1 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_RouteResponse_"
  /api/routes/{id}:
    get:
      operationId: getRoute_1
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getRoute_1 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RouteResponse"
  /api/scan/events/{scanEventId}/photos:
    post:
      operationId: addPhotosToScanEvent
      parameters:
      - name: scanEventId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                photos:
                  type: array
                  nullable: true
                  items:
                    type: string
                    format: binary
            encoding:
              photos:
                contentType: application/octet-stream
                explode: false
        required: true
      responses:
        "200":
          description: addPhotosToScanEvent 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/scan/events/{scanEventId}/photos/{photoId}:
    delete:
      operationId: deletePhotoFromScanEvent
      parameters:
      - name: scanEventId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: photoId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: deletePhotoFromScanEvent 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /api/scan/finish:
    post:
      operationId: finishScanMultipart
      requestBody:
        content:
          multipart/form-data:
            schema:
              required:
              - metadata
              type: object
              properties:
                metadata:
                  $ref: "#/components/schemas/FinishScanRequest"
                photos:
                  type: array
                  nullable: true
                  items:
                    type: string
                    format: binary
                subPhotos:
                  type: array
                  nullable: true
                  items:
                    type: string
                    format: binary
            encoding:
              metadata:
                contentType: application/octet-stream
                explode: false
              subPhotos:
                contentType: application/octet-stream
                explode: false
              photos:
                contentType: application/octet-stream
                explode: false
          application/json:
            schema:
              $ref: "#/components/schemas/FinishScanRequest"
            example: null
        required: true
      responses:
        "200":
          description: finishScanMultipart 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FinishScanResponse"
  /api/scan/start:
    post:
      operationId: startScan
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartScanRequest"
        required: true
      responses:
        "200":
          description: startScan 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StartScanResponse"
  /api/sites:
    get:
      operationId: listSites
      parameters:
      - name: organizationId
        in: query
        required: true
        explode: false
        schema:
          type: string
          format: uuid
      - name: page
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 0
      - name: size
        in: query
        required: true
        explode: false
        schema:
          type: integer
          format: int32
          default: 20
      responses:
        "200":
          description: listSites 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Page_SiteResponse_"
    post:
      operationId: createSite
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateSiteRequest"
        required: true
      responses:
        "200":
          description: createSite 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SiteResponse"
  /api/sites/{id}:
    get:
      operationId: getSite
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: getSite 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SiteResponse"
    put:
      operationId: updateSite
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateSiteRequest"
        required: true
      responses:
        "200":
          description: updateSite 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SiteResponse"
    delete:
      operationId: deleteSite
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: deleteSite 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: object
  /auth/dev/login:
    post:
      operationId: magicLogin
      parameters:
      - name: email
        in: query
        required: true
        explode: false
        schema:
          type: string
          default: admin@nfcwalker.com
      responses:
        "200":
          description: magicLogin 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /auth/health:
    get:
      operationId: health
      responses:
        "200":
          description: health 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
  /auth/invite/accept:
    post:
      operationId: acceptInvitation
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AcceptInvitationRequest"
        required: true
      responses:
        "200":
          description: acceptInvitation 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: object
  /auth/me:
    get:
      operationId: getMe
      responses:
        "200":
          description: getMe 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthMeResponse"
  /auth/oauth/google/callback:
    get:
      operationId: callback
      responses:
        "200":
          description: callback 200 response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
components:
  schemas:
    AcceptInvitationRequest:
      required:
      - token
      type: object
      properties:
        token:
          type: string
    AddRouteCheckpointRequest:
      required:
      - checkpointId
      - maxOffsetSec
      - minOffsetSec
      - seq
      type: object
      properties:
        checkpointId:
          type: string
          format: uuid
        seq:
          type: integer
          format: int32
        minOffsetSec:
          type: integer
          format: int32
        maxOffsetSec:
          type: integer
          format: int32
    AuthMeResponse:
      required:
      - roles
      - user
      type: object
      properties:
        user:
          $ref: "#/components/schemas/UserResponse"
        roles:
          type: object
          additionalProperties:
            $ref: "#/components/schemas/Role"
    BulkAddRouteCheckpointsRequest:
      required:
      - checkpoints
      type: object
      properties:
        checkpoints:
          type: array
          items:
            $ref: "#/components/schemas/AddRouteCheckpointRequest"
    CheckStatus:
      type: string
      enum:
      - OK
      - PROBLEMS_FOUND
      - SKIPPED
    CheckpointDetailsConfig:
      required:
      - allowNotes
      - requirePhoto
      type: object
      properties:
        requirePhoto:
          type: boolean
        allowNotes:
          type: boolean
        description:
          type: string
          nullable: true
    CheckpointResponse:
      required:
      - code
      - id
      - organizationId
      - siteId
      type: object
      properties:
        id:
          type: string
          format: uuid
        organizationId:
          type: string
          format: uuid
        siteId:
          type: string
          format: uuid
        code:
          type: string
        geoLat:
          type: number
          nullable: true
        geoLon:
          type: number
          nullable: true
        radiusM:
          type: number
          nullable: true
        label:
          type: string
          nullable: true
        detailsConfig:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/CheckpointDetailsConfig"
        subChecks:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/SubCheckResponse"
    CreateCheckpointRequest:
      required:
      - code
      - organizationId
      - siteId
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
        siteId:
          type: string
          format: uuid
        code:
          type: string
        geoLat:
          type: number
          nullable: true
        geoLon:
          type: number
          nullable: true
        radiusM:
          type: number
          nullable: true
        label:
          type: string
          nullable: true
        detailsConfig:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/CheckpointDetailsConfig"
        subChecks:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/SubCheckRequest"
    CreateInvitationRequest:
      required:
      - email
      - organizationId
      - role
      type: object
      properties:
        email:
          type: string
        organizationId:
          type: string
          format: uuid
        role:
          $ref: "#/components/schemas/Role"
    CreateOrganizationRequest:
      required:
      - name
      type: object
      properties:
        name:
          type: string
    CreateRouteRequest:
      required:
      - name
      - organizationId
      - siteId
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
        siteId:
          type: string
          format: uuid
        name:
          type: string
    CreateSiteRequest:
      required:
      - name
      - organizationId
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
        name:
          type: string
    DeviceResponse:
      required:
      - deviceId
      - id
      - registeredAt
      - status
      type: object
      properties:
        id:
          type: string
          format: uuid
        deviceId:
          type: string
        metadata:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/DeviceStatus"
        registeredAt:
          type: string
          format: date-time
        lastUsedAt:
          type: string
          format: date-time
          nullable: true
    DeviceStatus:
      type: string
      enum:
      - ACTIVE
      - INACTIVE
      - BLOCKED
    FinishScanRequest:
      required:
      - challenge
      - scannedAt
      type: object
      properties:
        challenge:
          type: string
        scannedAt:
          type: string
          format: date-time
        lat:
          type: number
          nullable: true
        lon:
          type: number
          nullable: true
        checkStatus:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/CheckStatus"
        checkNotes:
          type: string
          nullable: true
        subCheckResults:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/SubCheckResultRequest"
        incidents:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/IncidentCreateRequest"
    FinishScanResponse:
      required:
      - eventId
      - verdict
      type: object
      properties:
        eventId:
          type: string
          format: uuid
        verdict:
          $ref: "#/components/schemas/ScanVerdict"
    GeoConstraint:
      required:
      - lat
      - lon
      - radiusM
      type: object
      properties:
        lat:
          type: number
        lon:
          type: number
        radiusM:
          type: number
    IncidentCreateRequest:
      required:
      - description
      - severity
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
          nullable: true
        siteId:
          type: string
          format: uuid
          nullable: true
        description:
          type: string
        severity:
          $ref: "#/components/schemas/IncidentSeverity"
        checkpointId:
          type: string
          format: uuid
          nullable: true
        scanEventId:
          type: string
          format: uuid
          nullable: true
    IncidentPatchRequest:
      type: object
      properties:
        description:
          type: string
          nullable: true
        severity:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/IncidentSeverity"
        status:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/IncidentStatus"
    IncidentResponse:
      required:
      - createdAt
      - description
      - id
      - organizationId
      - reportedBy
      - severity
      - siteId
      - status
      - updatedAt
      type: object
      properties:
        id:
          type: string
          format: uuid
        organizationId:
          type: string
          format: uuid
        siteId:
          type: string
          format: uuid
        checkpointId:
          type: string
          format: uuid
          nullable: true
        scanEventId:
          type: string
          format: uuid
          nullable: true
        reportedBy:
          type: string
          format: uuid
        description:
          type: string
        severity:
          $ref: "#/components/schemas/IncidentSeverity"
        status:
          $ref: "#/components/schemas/IncidentStatus"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    IncidentSeverity:
      type: string
      enum:
      - LOW
      - MEDIUM
      - HIGH
      - CRITICAL
    IncidentStatus:
      type: string
      enum:
      - OPEN
      - IN_PROGRESS
      - RESOLVED
      - CLOSED
    InvitationResponse:
      required:
      - email
      - expiresAt
      - id
      - organizationId
      - role
      - status
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
        organizationId:
          type: string
          format: uuid
        role:
          $ref: "#/components/schemas/Role"
        status:
          $ref: "#/components/schemas/InvitationStatus"
        expiresAt:
          type: string
          format: date-time
    InvitationStatus:
      type: string
      enum:
      - PENDING
      - ACCEPTED
      - EXPIRED
      - REVOKED
    OrganizationResponse:
      required:
      - createdAt
      - id
      - name
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        createdAt:
          type: string
          format: date-time
    Page_CheckpointResponse_:
      required:
      - totalPages
      - totalSize
      type: object
      allOf:
      - $ref: "#/components/schemas/Slice_CheckpointResponse_"
      - type: object
        properties:
          totalSize:
            type: integer
            format: int64
          totalPages:
            type: integer
            format: int32
    Page_DeviceResponse_:
      required:
      - totalPages
      - totalSize
      type: object
      allOf:
      - $ref: "#/components/schemas/Slice_DeviceResponse_"
      - type: object
        properties:
          totalSize:
            type: integer
            format: int64
          totalPages:
            type: integer
            format: int32
    Page_IncidentResponse_:
      required:
      - totalPages
      - totalSize
      type: object
      allOf:
      - $ref: "#/components/schemas/Slice_IncidentResponse_"
      - type: object
        properties:
          totalSize:
            type: integer
            format: int64
          totalPages:
            type: integer
            format: int32
    Page_InvitationResponse_:
      required:
      - totalPages
      - totalSize
      type: object
      allOf:
      - $ref: "#/components/schemas/Slice_InvitationResponse_"
      - type: object
        properties:
          totalSize:
            type: integer
            format: int64
          totalPages:
            type: integer
            format: int32
    Page_OrganizationResponse_:
      required:
      - totalPages
      - totalSize
      type: object
      allOf:
      - $ref: "#/components/schemas/Slice_OrganizationResponse_"
      - type: object
        properties:
          totalSize:
            type: integer
            format: int64
          totalPages:
            type: integer
            format: int32
    Page_RouteResponse_:
      required:
      - totalPages
      - totalSize
      type: object
      allOf:
      - $ref: "#/components/schemas/Slice_RouteResponse_"
      - type: object
        properties:
          totalSize:
            type: integer
            format: int64
          totalPages:
            type: integer
            format: int32
    Page_SiteResponse_:
      required:
      - totalPages
      - totalSize
      type: object
      allOf:
      - $ref: "#/components/schemas/Slice_SiteResponse_"
      - type: object
        properties:
          totalSize:
            type: integer
            format: int64
          totalPages:
            type: integer
            format: int32
    Pageable:
      required:
      - mode
      - number
      - size
      - sort
      type: object
      allOf:
      - $ref: "#/components/schemas/Sort"
      - type: object
        properties:
          number:
            type: integer
            format: int32
          size:
            type: integer
            format: int32
          mode:
            $ref: "#/components/schemas/Pageable.Mode"
          sort:
            $ref: "#/components/schemas/Sort"
    Pageable.Mode:
      type: string
      enum:
      - CURSOR_NEXT
      - CURSOR_PREVIOUS
      - OFFSET
    RegisterDeviceRequest:
      required:
      - deviceId
      type: object
      properties:
        deviceId:
          type: string
        metadata:
          type: string
          nullable: true
    Role:
      type: string
      enum:
      - ROLE_APP_OWNER
      - ROLE_BOSS
      - ROLE_WORKER
    RouteResponse:
      required:
      - id
      - name
      - organizationId
      - siteId
      type: object
      properties:
        id:
          type: string
          format: uuid
        organizationId:
          type: string
          format: uuid
        siteId:
          type: string
          format: uuid
        name:
          type: string
    ScanPolicy:
      required:
      - checkpointId
      - order
      - runId
      - timeWindow
      type: object
      properties:
        runId:
          type: string
          format: uuid
        checkpointId:
          type: string
          format: uuid
        order:
          type: integer
          format: int32
        timeWindow:
          $ref: "#/components/schemas/TimeWindow"
        geo:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/GeoConstraint"
    ScanVerdict:
      type: string
      enum:
      - OK
      - WARNING
      - FAIL
    SiteResponse:
      required:
      - createdAt
      - id
      - name
      - organizationId
      type: object
      properties:
        id:
          type: string
          format: uuid
        organizationId:
          type: string
          format: uuid
        name:
          type: string
        createdAt:
          type: string
          format: date-time
    Slice_CheckpointResponse_:
      required:
      - content
      - empty
      - numberOfElements
      - offset
      - pageNumber
      - pageable
      - size
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/CheckpointResponse"
        pageable:
          $ref: "#/components/schemas/Pageable"
        pageNumber:
          type: integer
          format: int32
        offset:
          type: integer
          format: int64
        size:
          type: integer
          format: int32
        empty:
          type: boolean
        numberOfElements:
          type: integer
          format: int32
    Slice_DeviceResponse_:
      required:
      - content
      - empty
      - numberOfElements
      - offset
      - pageNumber
      - pageable
      - size
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/DeviceResponse"
        pageable:
          $ref: "#/components/schemas/Pageable"
        pageNumber:
          type: integer
          format: int32
        offset:
          type: integer
          format: int64
        size:
          type: integer
          format: int32
        empty:
          type: boolean
        numberOfElements:
          type: integer
          format: int32
    Slice_IncidentResponse_:
      required:
      - content
      - empty
      - numberOfElements
      - offset
      - pageNumber
      - pageable
      - size
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/IncidentResponse"
        pageable:
          $ref: "#/components/schemas/Pageable"
        pageNumber:
          type: integer
          format: int32
        offset:
          type: integer
          format: int64
        size:
          type: integer
          format: int32
        empty:
          type: boolean
        numberOfElements:
          type: integer
          format: int32
    Slice_InvitationResponse_:
      required:
      - content
      - empty
      - numberOfElements
      - offset
      - pageNumber
      - pageable
      - size
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/InvitationResponse"
        pageable:
          $ref: "#/components/schemas/Pageable"
        pageNumber:
          type: integer
          format: int32
        offset:
          type: integer
          format: int64
        size:
          type: integer
          format: int32
        empty:
          type: boolean
        numberOfElements:
          type: integer
          format: int32
    Slice_OrganizationResponse_:
      required:
      - content
      - empty
      - numberOfElements
      - offset
      - pageNumber
      - pageable
      - size
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/OrganizationResponse"
        pageable:
          $ref: "#/components/schemas/Pageable"
        pageNumber:
          type: integer
          format: int32
        offset:
          type: integer
          format: int64
        size:
          type: integer
          format: int32
        empty:
          type: boolean
        numberOfElements:
          type: integer
          format: int32
    Slice_RouteResponse_:
      required:
      - content
      - empty
      - numberOfElements
      - offset
      - pageNumber
      - pageable
      - size
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/RouteResponse"
        pageable:
          $ref: "#/components/schemas/Pageable"
        pageNumber:
          type: integer
          format: int32
        offset:
          type: integer
          format: int64
        size:
          type: integer
          format: int32
        empty:
          type: boolean
        numberOfElements:
          type: integer
          format: int32
    Slice_SiteResponse_:
      required:
      - content
      - empty
      - numberOfElements
      - offset
      - pageNumber
      - pageable
      - size
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/SiteResponse"
        pageable:
          $ref: "#/components/schemas/Pageable"
        pageNumber:
          type: integer
          format: int32
        offset:
          type: integer
          format: int64
        size:
          type: integer
          format: int32
        empty:
          type: boolean
        numberOfElements:
          type: integer
          format: int32
    Sort:
      required:
      - orderBy
      type: object
      properties:
        orderBy:
          type: array
          items:
            $ref: "#/components/schemas/Sort.Order"
    Sort.Order:
      required:
      - ascending
      - direction
      - ignoreCase
      - property
      type: object
      properties:
        ignoreCase:
          type: boolean
        direction:
          $ref: "#/components/schemas/Sort.Order.Direction"
        property:
          type: string
        ascending:
          type: boolean
    Sort.Order.Direction:
      type: string
      enum:
      - ASC
      - DESC
    StartScanRequest:
      required:
      - checkpointCode
      - deviceId
      - organizationId
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
        deviceId:
          type: string
        checkpointCode:
          type: string
    StartScanResponse:
      required:
      - challenge
      - policy
      type: object
      properties:
        challenge:
          type: string
        policy:
          $ref: "#/components/schemas/ScanPolicy"
    SubCheckRequest:
      required:
      - allowNotes
      - label
      - requirePhoto
      type: object
      properties:
        label:
          type: string
        description:
          type: string
          nullable: true
        requirePhoto:
          type: boolean
        allowNotes:
          type: boolean
    SubCheckResponse:
      required:
      - allowNotes
      - id
      - label
      - requirePhoto
      type: object
      properties:
        id:
          type: string
          format: uuid
        label:
          type: string
        description:
          type: string
          nullable: true
        requirePhoto:
          type: boolean
        allowNotes:
          type: boolean
    SubCheckResultRequest:
      required:
      - status
      - subCheckId
      type: object
      properties:
        subCheckId:
          type: string
          format: uuid
        status:
          $ref: "#/components/schemas/CheckStatus"
        notes:
          type: string
          nullable: true
    TimeWindow:
      required:
      - maxOffsetSec
      - minOffsetSec
      type: object
      properties:
        minOffsetSec:
          type: integer
          format: int32
        maxOffsetSec:
          type: integer
          format: int32
    UpdateCheckpointRequest:
      type: object
      properties:
        label:
          type: string
          nullable: true
        geoLat:
          type: number
          nullable: true
        geoLon:
          type: number
          nullable: true
        radiusM:
          type: number
          nullable: true
        detailsConfig:
          nullable: true
          allOf:
          - $ref: "#/components/schemas/CheckpointDetailsConfig"
        subChecks:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/SubCheckRequest"
    UpdateOrganizationRequest:
      required:
      - name
      type: object
      properties:
        name:
          type: string
    UpdateRouteRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
    UpdateSiteRequest:
      required:
      - name
      type: object
      properties:
        name:
          type: string
    UserResponse:
      required:
      - createdAt
      - email
      - id
      - name
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
        name:
          type: string
        createdAt:
          type: string
          format: date-time
